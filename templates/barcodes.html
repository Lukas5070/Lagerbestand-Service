<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Etiketten ‚Äì QR Avery L4743REV</title>
  <style>
    @page {
      size: A4;
      margin: 0;
    }

    html, body {
      margin: 0;
      padding: 0;
      font-family: Arial, sans-serif;
      font-size: 12px;
      overflow: hidden;
    }

    .seite {
      height: 297mm;
      width: 210mm;
      padding: 21.5mm 7mm;
      box-sizing: border-box;
      display: grid;
      grid-template-columns: repeat(2, 99.1mm);
      grid-template-rows: repeat(6, 42.3mm);
      gap: 0mm 2.5mm;
      page-break-after: always;
    }

    .etikett {
      box-sizing: border-box;
      padding: 3mm 2mm;
      text-align: center;
      overflow: hidden;
    }

    .etikett img {
      height: 32mm;
      max-width: 100%;
      margin: 2mm 0 1mm;
    }

    @media print {
      .noprint { display: none; }
    }

    .noprint {
      margin: 10px;
    }

    .neu-artikel {
      margin: 20px 10px;
      padding: 10px;
      background: #f8f9fa;
      border: 1px solid #ccc;
      border-radius: 5px;
    }

    .neu-artikel img {
      height: 50px;
      vertical-align: middle;
      margin-right: 10px;
    }

    .neu-artikel h2 {
      margin-top: 0;
    }

    .neu-eintrag {
      margin-bottom: 10px;
    }

    .neu-eintrag small {
      color: #666;
      font-size: 10px;
    }

    .druckbereich {
      display: block;
    }

    .druckbereich.ausblenden {
      display: none;
    }
  </style>
</head>
<body>

  <!-- Steuerelemente -->
  <div class="noprint">
    <a href="/" style="padding:6px 12px; background:#007BFF; color:#fff; text-decoration:none; border-radius:5px;">‚¨Ö Zur√ºck</a>
    <button onclick="zeigeNurNeue()" style="padding:6px 12px; background:#17a2b8; color:#fff; border:none; border-radius:5px;">üñ®Ô∏è Nur neue Etiketten drucken</button>
    <button onclick="zeigeAlle()" style="padding:6px 12px; background:#6c757d; color:#fff; border:none; border-radius:5px;">üì¶ Alle Etiketten drucken</button>
    <button onclick="window.print()" style="padding:6px 12px; background:#28a745; color:#fff; border:none; border-radius:5px;">üñ®Ô∏è Jetzt drucken</button>
    <p style="margin-top:10px;">Druckeinstellungen: A4 ¬∑ 100‚ÄØ% ¬∑ Keine R√§nder ¬∑ Hintergrundgrafiken ‚úÖ</p>
  </div>

  <!-- Zuletzt hinzugef√ºgte Artikel (nicht druckbar) -->
  <div class="noprint neu-artikel">
    <h2>üÜï Zuletzt hinzugef√ºgte Artikel</h2>
    {% if neue_artikel %}
      {% for art in neue_artikel %}
        <div class="neu-eintrag">
          <img src="{{ url_for('static', filename='barcodes/' + art.barcode_filename) }}" alt="Barcode">
          <strong>{{ art.name }}</strong><br>
          <small>ID: {{ art.barcode_filename[:-4] }} | Hinzugef√ºgt: {{ art.created_at.strftime('%d.%m.%Y %H:%M') if art.created_at else '‚Äì' }}</small>
        </div>
      {% endfor %}
    {% else %}
      <p>Keine neuen Artikel gefunden.</p>
    {% endif %}
  </div>

  <!-- Etiketten: NUR neue Artikel -->
  <div id="nur-neue" class="druckbereich ausblenden">
    {% for i in range(0, neue_artikel|length, 12) %}
      <div class="seite">
        {% for art in neue_artikel[i:i+12] %}
          <div class="etikett">
            <strong>{{ art.name }}</strong><br>
            <img src="{{ url_for('static', filename='barcodes/' + art.barcode_filename) }}"><br>
            <small>{{ art.barcode_filename[:-4] }}</small>
          </div>
        {% endfor %}
      </div>
    {% endfor %}
  </div>

  <!-- Etiketten: ALLE Artikel -->
  <div id="alle-artikel" class="druckbereich">
    {% for i in range(0, artikel|length, 12) %}
      <div class="seite">
        {% for art in artikel[i:i+12] %}
          <div class="etikett">
            <strong>{{ art.name }}</strong><br>
            <img src="{{ url_for('static', filename='barcodes/' + art.barcode_filename) }}"><br>
            <small>{{ art.barcode_filename[:-4] }}</small>
          </div>
        {% endfor %}
      </div>
    {% endfor %}
  </div>

  <!-- Umschalter -->
  <script>
    function zeigeNurNeue() {
      document.getElementById('nur-neue').classList.remove('ausblenden');
      document.getElementById('alle-artikel').classList.add('ausblenden');
    }

    function zeigeAlle() {
      document.getElementById('nur-neue').classList.add('ausblenden');
      document.getElementById('alle-artikel').classList.remove('ausblenden');
    }
  </script>

</body>
</html>
